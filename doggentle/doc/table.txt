CREATE USER gentle IDENTIFIED BY gentle ACCOUNT UNLOCK; --아이디gentle 비번gentle
GRANT CONNECT,RESOURCE,UNLIMITED TABLESPACE TO gentle; --gentle계정 권한부여
ALTER USER gentle DEFAULT TABLESPACE USERS;

------윗부분 먼저 실행(system 계정으로 접속하여 실행)하여 gentle계정 생성,----
------gentle 계정으로 접속하여 아랫부분 실행----------------------------------
DROP TABLE "MEMBER" CASCADE CONSTRAINTS;
DROP TABLE "CATEGORY" CASCADE CONSTRAINTS;
DROP TABLE "IMG" CASCADE CONSTRAINTS;
DROP TABLE "GOODS" CASCADE CONSTRAINTS;
DROP TABLE "ADDRESS" CASCADE CONSTRAINTS;
DROP TABLE "TRANSACTION" CASCADE CONSTRAINTS;
DROP TABLE "REVIEW" CASCADE CONSTRAINTS;
DROP TABLE "QNA" CASCADE CONSTRAINTS;
DROP TABLE "CART" CASCADE CONSTRAINTS;
DROP TABLE "ATTEND" CASCADE CONSTRAINTS;
DROP TABLE "CERT" CASCADE CONSTRAINTS;
DROP TABLE "CODE" CASCADE CONSTRAINTS;
DROP TABLE "POINT" CASCADE CONSTRAINTS;
------테이블 다시만들 때, 위에있는 drop문 복사하여 한번에 삭제하셈 ----------

CREATE TABLE member(
	mno NUMBER(4)
		CONSTRAINT MEMB_MNO_PK PRIMARY KEY,
	mail VARCHAR2(30 CHAR)
		CONSTRAINT MEMB_MAIL_UK UNIQUE
		CONSTRAINT MEMB_MAIL_NN NOT NULL,
	id VARCHAR2(30 CHAR)
		CONSTRAINT MEMB_ID_UK UNIQUE
		CONSTRAINT MEMB_ID_NN NOT NULL,
	pw VARCHAR2(30 CHAR)
		CONSTRAINT MEMB_PW_NN NOT NULL,
	bdate DATE
		CONSTRAINT MEMB_BDATE_NN NOT NULL,
	gen CHAR(1)
		CONSTRAINT MEMB_GEN_CK CHECK (gen IN('F', 'M'))
		CONSTRAINT MEMB_GEN_NN NOT NULL,
	jdate DATE DEFAULT sysdate
		CONSTRAINT MEMB_DATE_NN NOT NULL,
	isshow CHAR(3) DEFAULT 'cst'
		CONSTRAINT MEMB_SHOW_NN NOT NULL
		CONSTRAINT MEMB_SHOW_CK CHECK (isshow IN('cst', 'mng', 'ext'))
);

CREATE TABLE category(
	cano NUMBER(4)
		CONSTRAINT MRKT_MANO_PK PRIMARY KEY,
	upno NUMBER(6,0),
	caname VARCHAR2(30 CHAR)
		CONSTRAINT MRKT_NAME_NN NOT NULL,
	isshow CHAR(1) DEFAULT 'Y'
		CONSTRAINT MRKT_SHOW_NN NOT NULL
		CONSTRAINT MRKT_SHOW_CK CHECK (isshow IN('Y', 'N'))
);
CREATE TABLE img(
	ino NUMBER(6)
		CONSTRAINT IMG_INO_PK PRIMARY KEY,
	upname VARCHAR2(30 CHAR)
		CONSTRAINT IMG_UPN_NN NOT NULL,
	savename VARCHAR2(30 CHAR)
		CONSTRAINT IMG_SAN_UK UNIQUE
		CONSTRAINT IMG_SAN_NN NOT NULL,
	dir VARCHAR2(300 CHAR)
		CONSTRAINT IMG_DIR_NN NOT NULL,
	volume NUMBER
		CONSTRAINT IMG_VOL_NN NOT NULL,
	purpose CHAR(3)
		CONSTRAINT IMG_PUR_CK CHECK (purpose IN('gds', 'rev'))
		CONSTRAINT IMG_PUR_NN NOT NULL
);

CREATE TABLE goods(
	gno NUMBER(6)
		CONSTRAINT GODS_GNO_PK PRIMARY KEY,
	gname VARCHAR2(30 CHAR)
		CONSTRAINT GODS_GNAME_NN NOT NULL,
	gdetail VARCHAR2(4000 CHAR),
	stock NUMBER(5),
	price NUMBER(10)
		CONSTRAINT GODS_PRICE_NN NOT NULL,
	cano NUMBER(4)
		CONSTRAINT GODS_MANO_FK REFERENCES category(cano)
		CONSTRAINT GODS_MANO_NN NOT NULL,
	hits NUMBER(6)
		CONSTRAINT GODS_HITS_NN NOT NULL,
	salesdate DATE DEFAULT sysdate
		CONSTRAINT GODS_DATE_NN NOT NULL,
	ino NUMBER(6)
		CONSTRAINT GODS_INO_FK REFERENCES img(ino)
		CONSTRAINT GODS_INO_NN NOT NULL,
	issell CHAR(1) DEFAULT 'Y'
		CONSTRAINT GODS_SELL_NN NOT NULL
		CONSTRAINT GODS_SELL_CK CHECK (issell IN('Y', 'N'))
);

CREATE TABLE address(
	adno NUMBER(4)
		CONSTRAINT ADDR_ADNO_PK PRIMARY KEY,
	who VARCHAR2(10 CHAR)
		CONSTRAINT ADDR_WHO_NN NOT NULL,
	mno NUMBER(4)
		CONSTRAINT ADDR_MNO_FK REFERENCES member(mno)
		CONSTRAINT ADDR_MNO_NN NOT NULL,
	pno NUMBER(5),
	adrs VARCHAR2(300 CHAR)
		CONSTRAINT ADDR_ADRS_NN NOT NULL,
	contact VARCHAR2(30 CHAR)
		CONSTRAINT ADDR_CONTACT_NN NOT NULL,
	isuse CHAR(1) DEFAULT 'Y'
		CONSTRAINT ADDR_USE_NN NOT NULL
		CONSTRAINT ADDR_USE_CK CHECK (isuse IN('Y', 'N'))
);

CREATE TABLE transaction(
	tno NUMBER(6)
		CONSTRAINT TRSCT_TNO_PK PRIMARY KEY,
	adno NUMBER(4)
		CONSTRAINT TRSCT_ADNO_FK REFERENCES address(adno)
		CONSTRAINT TRSCT_ADNO_NN NOT NULL,
	gno NUMBER(6)
		CONSTRAINT TRSCT_GNO_FK REFERENCES goods(gno)
		CONSTRAINT TRSCT_GNO_NN NOT NULL,
	mno NUMBER(4)
		CONSTRAINT TRSCT_MNO_FK REFERENCES member(mno)
		CONSTRAINT TRSCT_MNO_NN NOT NULL,
	tdate DATE DEFAULT sysdate
		CONSTRAINT TRSCT_DATE_NN NOT NULL,
	dno NUMBER(6),
	ddate DATE,
	quantity NUMBER(4) DEFAULT 1
		CONSTRAINT TRSCT_QUANT_NN NOT NULL
);

CREATE TABLE review(
	rno NUMBER(6)
		CONSTRAINT RVW_RNO_PK PRIMARY KEY,
	tno NUMBER(6)
		CONSTRAINT RVW_TNO_FK REFERENCES transaction(tno)
		CONSTRAINT RVW_TNO_NN NOT NULL,
	title VARCHAR2(30 CHAR)
		CONSTRAINT RVW_TTL_NN NOT NULL,
	body VARCHAR2(300 CHAR)
		CONSTRAINT RVW_BDY_NN NOT NULL,
	score NUMBER(2)
		CONSTRAINT RVW_SCR_NN NOT NULL
		CONSTRAINT RVW_SCR_CK CHECK (score IN(00,01,02,03,04,05,06,07,08,09,10)),
	ino NUMBER(1)
		CONSTRAINT RVW_INO_FK REFERENCES img(ino)
		CONSTRAINT RVW_INO_NN NOT NULL,
	rdate DATE DEFAULT sysdate
		CONSTRAINT RVW_DATE_NN NOT NULL,
	isshow CHAR(1) DEFAULT 'Y'
		CONSTRAINT RVW_SHOW_CK CHECK (isshow IN('Y', 'N'))
);

CREATE TABLE qna(
	qno NUMBER(6)
		CONSTRAINT QNA_QNO_PK PRIMARY KEY,
	title VARCHAR2(30 CHAR)
		CONSTRAINT QNA_TTL_NN NOT NULL,
	body VARCHAR2(300 CHAR)
		CONSTRAINT QNA_BODY_NN NOT NULL,
	upqno NUMBER(6)
		CONSTRAINT QNA_UPQNO_FK REFERENCES qna(qno),
	mno NUMBER(4)
		CONSTRAINT QNA_MNO_FK REFERENCES member(mno)
		CONSTRAINT QNA_MNO_NN NOT NULL,
	qdate DATE DEFAULT sysdate
		CONSTRAINT QNA_DATE_NN NOT NULL,
	mng NUMBER(4)
		CONSTRAINT QNA_MNG_NN NOT NULL
		CONSTRAINT QNA_MNG_FK REFERENCES member(mno)
);

CREATE TABLE cart(
	cno NUMBER(6)
		CONSTRAINT CART_CNO_PK PRIMARY KEY,
	mno NUMBER(4)
		CONSTRAINT CART_MNO_FK REFERENCES member(mno)
		CONSTRAINT CART_MNO_NN NOT NULL,
	gno NUMBER(6)
		CONSTRAINT CART_GNO_FK REFERENCES goods(gno)
		CONSTRAINT CART_GNO_NN NOT NULL,
	isshow CHAR(1) DEFAULT 'Y'
		CONSTRAINT CART_SHOW_CK CHECK (isshow IN('Y', 'N'))
		CONSTRAINT CART_SHOW_NN NOT NULL,
	quantity NUMBER(4) DEFAULT 1
		CONSTRAINT CART_QUANT_NN NOT NULL
);

CREATE TABLE attend(
	ano NUMBER(6)
		CONSTRAINT ATT_ANO_PK PRIMARY KEY,
	mno NUMBER(4)
		CONSTRAINT ATT_MNO_FK REFERENCES member(mno)
		CONSTRAINT ATT_MNO_NN NOT NULL,
	adate DATE DEFAULT sysdate
		CONSTRAINT ATT_DATE_NN NOT NULL
);

CREATE TABLE cert(
	cno NUMBER(6)
		CONSTRAINT CERT_CNO_PK PRIMARY KEY,
	ccode NUMBER(6)
		CONSTRAINT CERT_CODE_NN NOT NULL,
	cdate DATE DEFAULT sysdate
		CONSTRAINT CERT_DATE_NN NOT NULL,
	cmail VARCHAR2(30 CHAR)
		CONSTRAINT CERT_MAIL_NN NOT NULL,
	isverify CHAR(1) DEFAULT 'N'
		CONSTRAINT CERT_VERI_CK CHECK (isverify IN('Y', 'N'))
		CONSTRAINT CERT_VERI_NN NOT NULL
);

CREATE TABLE code(
	cno NUMBER(3)
		CONSTRAINT CODE_CNO_PK PRIMARY KEY,
	body VARCHAR2(30 CHAR)
		CONSTRAINT CODE_BODY_NN NOT NULL,
	upcno NUMBER(3)
		CONSTRAINT CODE_UPC_FK REFERENCES code(cno)
);


CREATE TABLE point(
	pno NUMBER(6)
		CONSTRAINT POINT_PNO_PK PRIMARY KEY,
	mno NUMBER(4)
		CONSTRAINT POINT_MNO_FK REFERENCES member(mno)
		CONSTRAINT POINT_MNO_NN NOT NULL,
	cno NUMBER(3)
		CONSTRAINT POINT_CNO_FK REFERENCES code(cno)
		CONSTRAINT POINT_CNO_NN NOT NULL,
	pvalue NUMBER(4)
		CONSTRAINT POINT_VAL_NN NOT NULL,
	sumpoint NUMBER
		CONSTRAINT POINT_SUM_NN NOT NULL
);